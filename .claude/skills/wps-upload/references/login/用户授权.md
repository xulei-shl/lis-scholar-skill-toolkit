[ç”¨æˆ·æˆæƒæµç¨‹](https://365.kdocs.cn/3rd/open/documents/app-integration-dev/wps365/server/certification-authorization/user-authorization/flow)
=======================================================================================================================================


æµç¨‹è¯´æ˜
----

1ã€å¼€å‘è€…åœ¨`å¼€å‘è€…åå°-å®‰å…¨è®¾ç½®`é…ç½®å›è°ƒåœ°å€ã€‚ 2ã€ç”¨æˆ·è®¿é—®åº”ç”¨æ—¶ï¼Œåº”ç”¨æŒ‰è¦æ±‚æ„é€ æˆæƒè·³è½¬é“¾æ¥ã€‚ç”¨æˆ·æˆæƒæˆåŠŸåï¼Œé¡µé¢å°†é‡å®šå‘åˆ°æˆæƒå›è°ƒåœ°å€ `redirect_uri`ï¼Œå¹¶é™„å¸¦ `code` å’Œ `state` å‚æ•°ã€‚å¦‚ï¼š`redirect_uri?code={string}&state={string}`ã€‚ 3ã€é€šè¿‡ `code` [è·å–ç”¨æˆ· access\_token](/3rd/open/documents/app-integration-dev/wps365/server/certification-authorization/get-token/get-user-access-token)ã€‚ 4ã€é€šè¿‡ç”¨æˆ· access\_token [è·å–ç”¨æˆ·ä¿¡æ¯](/3rd/open/documents/app-integration-dev/wps365/server/certification-authorization/user-authorization/user-info)ã€‚

![](https://cloudcdn.qwps.cn/open/_img/f1bc475482.png)

æ„é€ æˆæƒè·³è½¬é“¾æ¥
--------

æ ¹æ®å®šä¹‰ï¼Œæ„é€ æˆæƒè·³è½¬é“¾æ¥ï¼Œç”¨æˆ·åŒæ„æˆæƒåï¼Œä¼šé‡å®šå‘è·³è½¬åˆ°æŒ‡å®šçš„ `redirect_uri`ï¼Œå¹¶é™„å¸¦ `code`ã€`state` ä¸¤ä¸ªå‚æ•°ã€‚

**è¯·æ³¨æ„ï¼šç¬¬ä¸‰æ–¹ä¼ä¸šåº”ç”¨æ¥å…¥WPSåº”ç”¨å¸‚åœºæ—¶ï¼Œéœ€ä½¿ç”¨åº”ç”¨å¸‚åœºä¸“ç”¨æˆæƒæ¥å£ï¼š**[ISVåº”ç”¨æˆæƒæ¥å£](https://kdocs.cn/l/ciQyBkr15Rq3)

### è¯·æ±‚è¯´æ˜

| **è¯·æ±‚åœ°å€** | [https://openapi.wps.cn/oauth2/auth](https://openapi.wps.cn/oauth2/auth) |
| --- | --- |
| **è¯·æ±‚æ–¹æ³•** | GET |
| **ç­¾åæ–¹å¼** | æ—  |
| **æ”¯æŒåº”ç”¨ç±»å‹** | ä¼ä¸šè‡ªå»ºåº”ç”¨ã€ç¬¬ä¸‰æ–¹ä¼ä¸šåº”ç”¨ã€ç¬¬ä¸‰æ–¹ä¸ªäººåº”ç”¨ |
| **æƒé™è¦æ±‚** | æ—  |

### æŸ¥è¯¢å‚æ•°ï¼ˆqueryï¼‰

| **å‚æ•°** | **å‚æ•°ç±»å‹** | **æ˜¯å¦å¿…å¡«** | **è¯´æ˜** |
| --- | --- | --- | --- |
| client\_id | string | æ˜¯ | åº”ç”¨ APPID |
| response\_type | string | æ˜¯ | å‚æ•°å€¼å¿…é¡»ä¸º `code` |
| redirect\_uri | string | æ˜¯ | ä½¿ç”¨å¼€è€…åå°åº”ç”¨é…ç½®çš„ã€ç”¨æˆ·æˆæƒå›è°ƒåœ°å€ã€‘ç»è¿‡encodeåçš„å€¼ |
| scope | string | æ˜¯ | ç”¨æˆ·æˆæƒçš„æƒé™ï¼Œä½¿ç”¨è‹±æ–‡é€—å·åˆ†éš”ï¼Œå¦‚ï¼š`scope1,scope2,scope3` |
| state | string | å¦ | åº”ç”¨è‡ªå®šä¹‰æ•°æ®ï¼ŒæˆæƒæˆåŠŸåé‡å®šå‘æ—¶ä¼šå¸¦å‡º |

### è¯·æ±‚åœ°å€ç¤ºä¾‹

```
[GET] https://openapi.wps.cn/oauth2/auth?response_type=code&client_id={string}&redirect_uri={string}&scope={scope1,scope2,scope3}&state={string}
```

### è¯·æ±‚å“åº”

*   è‹¥ç”¨æˆ·æœªç™»å½•ï¼Œåˆ™ä¼šå…ˆè·³è½¬åˆ°ç™»å½•é¡µè¿›è¡Œç™»å½•ï¼š

![](https://cloudcdn.qwps.cn/open/_img/fe3c347bd4.png)

*   è‹¥ç”¨æˆ·å·²ç™»å½•æœªæˆæƒï¼Œåˆ™ä¼šå…ˆè·³è½¬åˆ°æˆæƒé¡µï¼š

![](https://cloudcdn.qwps.cn/open/_img/8e1198f143.png)

*   è‹¥ç”¨æˆ·å·²æˆæƒï¼Œåˆ™é‡å®šå‘åˆ° `redirect_uri`ï¼Œå¹¶æºå¸¦**ä¸´æ—¶æˆæƒç  `code` å’Œç”¨æˆ·è‡ªå®šä¹‰å‚æ•° `state`**ã€‚ç¤ºä¾‹ï¼š`redirect_uri?code={string}&state={string}`ã€‚

ğŸ“Œ **æ³¨æ„ï¼š`code` ä½œä¸ºæ¢å– access\_token çš„ç¥¨æ®ï¼Œä»…å¯ä½¿ç”¨ä¸€æ¬¡ä¸” 10 åˆ†é’Ÿæœªè¢«ä½¿ç”¨è‡ªåŠ¨è¿‡æœŸã€‚**

æ ¹æ® code è·å–ç”¨æˆ· access\_token
--------------------------

åº”ç”¨è·å–åˆ° `code` ä¹‹åï¼ŒæœåŠ¡ç«¯è°ƒç”¨è¯¥æ¥å£è·å–ç”¨äºè®¿é—®ç”¨æˆ·æˆæƒå‡­è¯ access\_tokenã€‚è¯¦è§[è·å–ç”¨æˆ· access\_token](/3rd/open/documents/app-integration-dev/wps365/server/certification-authorization/get-token/get-user-access-token)ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼šç”±äºåº”ç”¨ APPKEY å’Œè·å–åˆ°çš„ access\_token å®‰å…¨çº§åˆ«æ¯”è¾ƒé«˜ï¼Œåç»­åˆ·æ–° access\_tokenã€é€šè¿‡ access\_token è·å–ç”¨æˆ·ä¿¡æ¯ç­‰æ­¥éª¤ï¼Œå¿…é¡»ä»æœåŠ¡å™¨è°ƒç”¨æ¥å£ã€‚

åˆ·æ–°ç”¨æˆ· access\_token
------------------

access\_token çš„æœ‰æ•ˆæœŸä¸º 2 å°æ—¶ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ refresh\_token è°ƒç”¨[åˆ·æ–°ç”¨æˆ· access\_token](/3rd/open/documents/app-integration-dev/wps365/server/certification-authorization/get-token/refresh-user-access-token)é‡æ–°è·å–ä¸€ä¸ªæœ‰æ•ˆçš„ access\_tokenã€‚éœ€æ³¨æ„ 2 ç‚¹ï¼š

*   è‹¥åŸ access\_token æœªè¿‡æœŸï¼ŒåŸ access\_token ä»å¯ä½¿ç”¨ï¼Œç›´åˆ°åŸæœ‰æ•ˆæœŸæˆªæ­¢å¤±æ•ˆ
*   é‡æ–°è·å–çš„ access\_token çš„å€¼ä¸åŸ access\_token **ä¸ä¸€è‡´**ï¼Œè¯·æ³¨æ„åŒºåˆ†ä½¿ç”¨

refresh\_token æœ‰æ•ˆæœŸä¸º 365 å¤©ï¼Œå½“ refresh\_token å¤±æ•ˆä¹‹åï¼Œéœ€è¦ç”¨æˆ·é‡æ–°æˆæƒã€‚ ä½¿ç”¨ refresh\_token åˆ·æ–° access\_token æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„ refresh\_tokenï¼ŒåŸ refresh\_token è‡ªåŠ¨å¤±æ•ˆã€‚

[ä¸Šä¸€ç¯‡ï¼šè®¤è¯ä¸æˆæƒæ¦‚è¿°](/3rd/open/documents/app-integration-dev/wps365/server/certification-authorization/summary)[ä¸‹ä¸€ç¯‡ï¼šè·å–ç”¨æˆ·ä¿¡æ¯](/3rd/open/documents/app-integration-dev/wps365/server/certification-authorization/user-authorization/user-info)